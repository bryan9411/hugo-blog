---
title: 'Git: 修改提交與重置'
date: '2023-11-08T21:17:32+08:00'
author: 'Bryan'
tags: ['git']
categories: ['Git 版本控制']
isCJKLanguage: true
draft: false
---
![git](/images/Git/banner.jpeg)

再 [Git: 基本指令](/posts/git-01) 介紹到一些基本 git 指令，但還有更多實用的指令 👇

# 修改提交(amend)
```
git commit --amend
```
如果這次修改只是增加註解或者刪除多餘 log 之類的，並沒有其他功能，這樣的話用 `--amend` 可以直接修改目前 commit 紀錄，避免多一個新 commit

# 撤銷提交(reset)
reset 有三種模式可選，分別是 `--soft`、`--mixed` 和 `--hard`
可以用來撤銷提交、重置分支、取消暫存等操作

| 模式    | 說明                                                               |
| ------- | ------------------------------------------------------------------ |
| --soft  | 撤銷最近的提交，但保留修改的文件，通常用於將提交合併到一個新的提交 |
| --mixed | 取消暫存文件                                                       |
| --hard  | 刪除提交，一但刪除就救不回來了，使用時需小心                       |


1. 撤銷最近的提交，保留修改的文件：
   ```
   git reset --soft HEAD~1
   ```
   使用情境：你最近提交了一個錯誤的修改，但想要將這些修改合併到一個新的提交中
   
2. 指定檔案取消暫存：
   ```
   git reset --mixed HEAD hello.ts
   ```
   使用情境：你對某個檔案進行了修改並暫存，但後來決定不想提交這些修改
   
3. 刪除最近的提交及修改的文件：
   ```
   git reset --hard HEAD~1
   ```
   使用情境：你提交了一個錯誤的修改，現在想要完全刪除這個提交及修改的文件
    
如果不清楚 `HEAD~1` 的意思，還有個更簡單做法：

1. 使用 `git log` 查看要回到的提交的 SHA 值。
2. 複製該 SHA 值。
3. 執行 `git reset <SHA>`，回到指定的提交位置並保留修改的文件。

# 重置基底(rebase)
| 指令       | 說明                                                                                         |
| ---------- | -------------------------------------------------------------------------------------------- |
| `rebase`   | 從遠端拉取最新資料，並將本地未提交的修改與拉取的最新資料合併，生成一個新的提交紀錄           |
| `--rebase` | 從遠端拉取最新資料，但直接將本地未提交的修改更新到最新的程式碼，避免產生不必要的合併提交紀錄 |

假設你在本地也有一些未提交的修改，並想要從遠端的 origin/dev 分支拉取最新的資料 👇

* rebase：
   如果拉取的最新的資料想要合併到你的本地分支且希望產生一個 commit 紀錄
   ```
   git pull rebase origin dev
   ```
    這將從遠端的 origin/dev 分支拉取最新的資料，並將你的本地未提交的修改與這些最新的資料進行合併。最後，產生一個 commit 紀錄

* --rebase：
   反之，如果不想產生額外的 commit 紀錄的話
   ```
   git pull --rebase origin dev
   ```
    這將從遠端的 origin/dev 分支拉取最新的資料，並直接將你的本地未提交的修改更新到這些最新的程式碼上。且不會產生 commit 紀錄
